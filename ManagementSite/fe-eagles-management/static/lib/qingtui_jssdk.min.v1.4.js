!function(e,t){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return t(e)}):"object"==typeof exports?module.exports=t(e):t(e,!0)}(this,function(t,n){function i(e,n,i){t.QingtuiJSBridge?QingtuiJSBridge.invoke(e,o(n),function(t){r(e,t,i)}):u(e,i)}function o(e){return e=e||{},e.appId=QTconfig.appId,e.verifyAppId=QTconfig.appId,e.verifySignType="sha1",e.verifyTimestamp=QTconfig.timestamp+"",e.verifyNonceStr=QTconfig.nonceStr,e.verifySignature=QTconfig.signature,e}function r(e,t,n){console.log(e,n);var i,o;switch(delete t.err_code,delete t.err_desc,delete t.err_detail,(i=t.errMsg)||(i=t.err_msg||"failed_client_error",delete t.err_msg,i=s(e,i),t.errMsg=i),(n=n||{})._complete&&(n._complete(t),delete n._complete),i=t.errMsg||"",QTconfig.debug&&!n.isInnerInvoke&&alert(JSON.stringify(t)),o=i.indexOf(":"),i.substring(o+1)){case"ok":n.success&&n.success(t);break;case"cancel":n.cancel&&n.cancel(t);break;default:n.fail&&n.fail(t)}n.complete&&n.complete(t)}function s(e,t){var n,i=e,o=p[i];return o&&(i=o),"confirm"==(n=t.substring(NaN))&&(n="ok"),"failed"==n&&(n="fail"),-1!=n.indexOf("failed_")&&(n=n.substring(7)),-1!=n.indexOf("fail_")&&(n=n.substring(5)),n=n.replace(/_/g," "),"access denied"!=(n=n.toLowerCase())&&"no permission to execute"!=n||(n="permission denied"),"config"==i&&"function not exist"==n&&(n="ok"),""==n&&(n="fail"),t=i+":"+n}function c(e){var t,n,i;if(e){for(t=0;t<e.length;t++)n=e[t],(i=m[n])&&(e[t]=i);return e}}function u(e,t){if(!(!QTconfig.debug||t&&t.isInnerInvoke)){var n=v[e];n&&(e=n),t&&t._complete&&delete t._complete,console.log('"'+e+'",',t||"")}}function d(){0!=V.preVerifyState&&(M||w||QTconfig.debug||"420">O||V.systemType<0||b||(b=!0,V.appId=QTconfig.appId,V.initTime=J.initEndTime-J.initStartTime,V.preVerifyTime=J.preVerifyEndTime-J.preVerifyStartTime,G.getNetworkType({isInnerInvoke:!0,success:function(e){var t;V.networkType=e.networkType,t="http://open.weixin.qq.com/sdk/report?v="+V.version+"&o="+V.preVerifyState+"&s="+V.systemType+"&c="+V.clientVersion+"&a="+V.appId+"&n="+V.networkType+"&i="+V.initTime+"&p="+V.preVerifyTime+"&u="+V.url,new Image,console.log(t)}})))}function l(){return(new Date).getTime()}function g(e){_&&(t.QingtuiJSBridge?e():h.addEventListener&&h.addEventListener("QingtuiJSBridgeReady",e,!1))}function f(){G.invoke||(G.invoke=function(t,n,i){a.QingtuiJSBridge&&QingtuiJSBridge.invoke(t,e(n),i)},G.on=function(e,t){a.QingtuiJSBridge&&QingtuiJSBridge.on(e,t)})}!function(){var e;try{e=typeof t.webkit.messageHandlers.QingtuiJSBridge}catch(t){e="undefined"}t.QingtuiJSBridge?void 0===QingtuiJSBridge.invoke&&(QingtuiJSBridge._list={},QingtuiJSBridge.invoke=function(e,t,n){var i=Math.random().toString(36).replace("0.","qt");this._list[i]=n,this._invoke(JSON.stringify({funName:e,params:t,tag:i}))},QingtuiJSBridge._result=function(e,t,n,i){i=i||!1;var o=JSON.parse(t);this._list[n](o),i||delete this._list[n]}):"undefined"!=e&&(QingtuiJSBridge=t.webkit.messageHandlers.QingtuiJSBridge,void 0===QingtuiJSBridge.invoke&&(QingtuiJSBridge._list={},QingtuiJSBridge.invoke=function(e,t,n){var i=Math.random().toString(36).replace("0.","qt");this._list[i]=n,this.postMessage(JSON.stringify({funName:e,params:t,tag:i}))},QingtuiJSBridge._result=function(e,t,n,i){i=i||!1;var o=JSON.parse(t);this._list[n](o),i||delete this._list[n]}))}();var m,v,h,S,T,M,w,_,Q,I,O,b,J,V,P,k,G,B,L=function(){var e=3.141592653589793,t=6378245,n=.006693421622965943,i=function(t,n){var i=(t=+t)-.0065,o=(n=+n)-.006,r=Math.sqrt(i*i+o*o)-2e-5*Math.sin(o*e),a=Math.atan2(o,i)-3e-6*Math.cos(i*e);return[r*Math.cos(a),r*Math.sin(a)]},o=function(t,n){var i=t=+t,o=n=+n,r=Math.sqrt(i*i+o*o)+2e-5*Math.sin(o*e),a=Math.atan2(o,i)+3e-6*Math.cos(i*e);return[r*Math.cos(a)+.0065,r*Math.sin(a)+.006]},r=function(i,o){if(u(i=+i,o=+o))return[i,o];var r=s(i-105,o-35),a=c(i-105,o-35),d=o/180*e,p=Math.sin(d);p=1-n*p*p;var l=Math.sqrt(p);return r=180*r/(t*(1-n)/(p*l)*e),[2*i-(i+(a=180*a/(t/l*Math.cos(d)*e))),2*o-(o+r)]},a=function(i,o){if(u(i=+i,o=+o))return[i,o];var r=s(i-105,o-35),a=c(i-105,o-35),d=o/180*e,p=Math.sin(d);p=1-n*p*p;var l=Math.sqrt(p),g=o+(r=180*r/(t*(1-n)/(p*l)*e));return[i+(a=180*a/(t/l*Math.cos(d)*e)),g]},s=function(t,n){var i=2*(t=+t)-100+3*(n=+n)+.2*n*n+.1*t*n+.2*Math.sqrt(Math.abs(t));return i+=2*(20*Math.sin(6*t*e)+20*Math.sin(2*t*e))/3,i+=2*(20*Math.sin(n*e)+40*Math.sin(n/3*e))/3,i+=2*(160*Math.sin(n/12*e)+320*Math.sin(n*e/30))/3},c=function(t,n){var i=300+(t=+t)+2*(n=+n)+.1*t*t+.1*t*n+.1*Math.sqrt(Math.abs(t));return i+=2*(20*Math.sin(6*t*e)+20*Math.sin(2*t*e))/3,i+=2*(20*Math.sin(t*e)+40*Math.sin(t/3*e))/3,i+=2*(150*Math.sin(t/12*e)+300*Math.sin(t/30*e))/3},u=function(e,t){var t=+t;return!((e=+e)>73.66&&e<135.05&&t>3.86&&t<53.55)};return{bd09togcj02:i,gcj02tobd09:o,gcj02towgs84:r,bd09towgs84:function(e,t){var n=i(e,t);return r(n[0],n[1])},wgs84togcj02:a,wgs84tobd09:function(e,t){var n=a(e,t);return o(n[0],n[1])}}}();if(console.log(t,n),!t.jQingTui)return m={config:"config",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"previewImage",getLocation:"getLocation",startGeoLocation:"startGeoLocation",stopGeoLocation:"stopGeoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest"},v=function(){var e,t={};for(e in m)t[m[e]]=e;return t}(),h=t.document,h.title,S=navigator.userAgent.toLowerCase(),T=navigator.platform.toLowerCase(),M=!(!T.match("mac")&&!T.match("win")),w=-1!=S.indexOf("qtdebugger"),_=-1!=S.indexOf("qingtui"),Q=-1!=S.indexOf("android"),I=-1!=S.indexOf("iphone")||-1!=S.indexOf("ipad"),O=function(){var e=S.match(/qingtui\/(\d+\.\d+\.\d+)/)||S.match(/qingtui\/(\d+)/);return e?e[1]:""}(),b=!1,!1,J={initStartTime:l(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},V={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",preVerifyState:1,systemType:I?1:Q?2:-1,clientVersion:O,url:encodeURIComponent(location.href)},QTconfig={debug:!1,check:!1},P={_completes:[]},k={state:0,data:{}},g(function(){J.initEndTime=l()}),B={coverntType:function(e,t){var n=e.type||"wgs84";e.longitude=parseFloat(e.longitude),e.latitude=parseFloat(e.latitude);var i=[e.longitude,e.latitude];V.clientVersion>=400&&void 0===e.type&&2==V.systemType&&(n="bd09"),n!=t&&("bd09"==n&&"wgs84"==t?i=L.bd09towgs84(e.longitude,e.latitude):"bd09"==n&&"gcj02"==t?i=L.bd09togcj02(e.longitude,e.latitude):"gcj02"==n&&"wgs84"==t?i=L.gcj02towgs84(e.longitude,e.latitude):"gcj02"==n&&"bd09"==t?i=L.gcj02tobd09(e.longitude,e.latitude):"wgs84"==n&&"bd09"==t?i=L.wgs84tobd09(e.longitude,e.latitude):"wgs84"==n&&"gcj02"==t&&(i=L.wgs84togcj02(e.longitude,e.latitude))),e.longitude=i[0],e.latitude=i[1],delete e.type},geoOptionMap:{},geoProssStatus:!1,startGeoOPStatus:!1,geoProssRes:{latitude:1,longitude:2,precision:300,addr:"sss"},startGeoPross:function(e){var t,n=(new Date).getTime();i(m.startGeoLocation,e,(e.success=function(e){B.geoProssRes=e,B.geoProssStatus=!0,t=(new Date).getTime(),console.log("geo pross is start",t-n),B.startGeoOPStatus||B.startGeoOP(),n=(new Date).getTime()},e))},stopGeoPross:function(e){var t=B.geoOptionMap;if("{}"!=JSON.stringify(t))for(var n in t)t.hasOwnProperty(n)&&B.removeGeoOption(n);B.geoProssStatus?(i(m.stopGeoLocation,{},(e._complete=function(){B.geoProssStatus=!1,B.startGeoOPStatus=!1},e)),console.log("stopGeoLocation")):(e.success&&e.success(),console.log("stopGeoLocation id al"))},startGeoOP:function(){var e=B.geoOptionMap;B.startGeoOPStatus=!0;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t],i=n._success(t);n.geoId=i}},addGeoOption:function(e){var t=Math.random().toString().replace("0.","geo_");if(e._success=function(t){return setInterval(function(){var n=B.geoProssRes,i={latitude:n.latitude,longitude:n.longitude,precision:parseInt(n.precision),type:n.type,id:t};e.formatAddr&&(i.addr=n.addr),B.coverntType(i,e.type),e.success(i)},e.interval)},e.id=t,B.geoOptionMap[t]=e,B.startGeoOPStatus){var n=e._success(t);e.geoId=n}},removeGeoOption:function(e){var t=B.geoOptionMap[e];t.geoId&&(clearInterval(t.geoId),delete B.geoOptionMap[e])}},G={config:function(e){QTconfig=e,u("config",e);var t=!1!==QTconfig.check;g(function(){var e;if(t)J.preVerifyStartTime=l(),i(m.config,{verifyJsApiList:c(QTconfig.jsApiList)},function(){P._complete=function(e){J.preVerifyEndTime=l(),k.state=1,k.data=e},P.success=function(){V.preVerifyState=0},P.fail=function(e){P._fail?P._fail(e):k.state=-1};var e=P._completes;return e.push(function(){d()}),P.complete=function(){for(var t=0,n=e.length;n>t;++t)e[t]();P._completes=[]},P}()),J.preVerifyStartTime=l();else{k.state=1;for(var n=(e=P._completes).length,o=0;n>o;++o)e[o]();P._completes=[]}}),QTconfig.beta&&f()},startRecord:function(e){i("startRecord",{},e)},stopRecord:function(e){i("stopRecord",{},e)},onVoiceRecordEnd:function(e){i("onVoiceRecordEnd",{},e)},playVoice:function(e){i("playVoice",{localId:e.localId},e)},pauseVoice:function(e){i("pauseVoice",{localId:e.localId},e)},stopVoice:function(e){i("stopVoice",{localId:e.localId},e)},onVoicePlayEnd:function(e){i("onVoicePlayEnd",{},e)},chooseImage:function(e){i("chooseImage",{count:e.count||9,sizeType:e.sizeType||["original","compressed"],sourceType:e.sourceType||["album","camera"]},(e._complete=function(e){if("string"==typeof e.localIds){var t=e.localIds;t&&(e.localIds=JSON.parse(t))}},e))},previewImage:function(e){i(m.previewImage,{btns:e.btns||["forward","download"],current:e.current,urls:e.urls},e)},getNetworkType:function(e){var t=S.match(/nettype\/(\w+)/);console.log(t),e.success&&t&&e.success({networkType:t[1]})},getLocation:function(e){if(e=e||{},console.log(O),e.interval&&e.interval>0){if(O<430)return void(e.fail&&e.fail({errMsg:"client version not suppout interval"}));if(e.interval=e.interval<1e3?1e3:e.interval,B.geoProssStatus)B.addGeoOption(e);else{var t={};I&&(t.distance=10),Q&&(t.interval=1e3),B.startGeoPross(t),B.addGeoOption(e)}}else i(m.getLocation,{type:e.type||"wgs84",formatAddr:e.formatAddr||!1,interval:e.interval||0},(e._complete=function(e){console.log(e),B.coverntType(e,this.type)},e))},stopLocation:function(e){(e=e||{}).id?(B.removeGeoOption(e.id),"{}"==JSON.stringify(B.geoOptionMap)?B.stopGeoPross(e):e.success&&e.success()):B.stopGeoPross(e)},closeWindow:function(e){i("closeWindow",{},e=e||{})},scanQRCode:function(e){i("scanQRCode",{needResult:(e=e||{}).needResult||0},(e._complete=function(e){var t,n;y=!1,y&&(t=e.resultStr)&&(n=JSON.parse(t),e.resultStr=n&&n.scan_code&&n.scan_code.scan_result)},e))},openChat:function(e){i("openChat",{chatType:(e=e||{}).chatType||"chat",chatId:e.chatId||""},e)},openSignChat:function(e){i("openSingleChatView",{id:(e=e||{}).id||"",scope:e.scope||"open"},e)},openUserDetail:function(e){i("openUserDetail",{id:(e=e||{}).id||"",scope:e.scope||"open"},e)},openContacts:function(e){i("openContacts",{max:(e=e||{}).max||1,multiple:e.multiple||!1,scope:e.scope||"open",users:e.users||[],title:e.title||"选择联系人",needSelf:e.needSelf||!1,allowClear:e.empty||!1},e)},getJsApiVersion:function(e){i("getJsApiVersion",{},e=e||{})},ajax:function(e){var t={url:(e=e||{}).url,header:e.header,method:e.type},n=e.dataType||"json";"post"==e.type.toLowerCase()?t.bodyParams=e.data:t.urlParams=e.data,"json"==n&&(e._complete=function(e){var t,n;t=e.result;try{n=JSON.parse(t)}catch(e){n=t}finally{e.result=n}}),i("sendHttp",t,e)},getClientInfo:function(e){e=e||{};var t={};return _?M?t.type="pc":Q?t.type="android":I&&(t.type="ios"):t.type="not QT client",t.version=O,e.success&&e.success(t),t}},n&&(t.qt=t.jQingTui=G),G});